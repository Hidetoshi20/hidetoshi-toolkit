# OpenClaw VM Environment (UTM)

> æœ€åæ›´æ–°: 2026-02-11
> ç”¨é€”: OpenClaw å¼€å‘ä¸è¿è¡Œç¯å¢ƒ

---

## ğŸ“¦ è™šæ‹ŸæœºåŸºæœ¬ä¿¡æ¯

| é¡¹ç›®           | ä¿¡æ¯                                      |
| -------------- | ----------------------------------------- |
| **è™šæ‹ŸåŒ–è½¯ä»¶** | UTM                                       |
| **æ“ä½œç³»ç»Ÿ**   | Ubuntu 24.04 LTS (ARM64)                  |
| **å­˜å‚¨ä½ç½®**   | å¤–æ¥ç¡¬ç›˜ (å¯åŠ¨å‰è¯·ç¡®ä¿å·²æŒ‚è½½)             |
| **ç½‘ç»œæ¨¡å¼**   | **Emulated VLAN** (ä¸ºäº†å…¼å®¹å®¿ä¸»æœº VPN)    |
| **IP åœ°å€**    | NAT å†…éƒ¨ (å®¿ä¸»æœºä¸å¯ç›´æ¥è®¿é—®ï¼Œéœ€ç«¯å£è½¬å‘) |
| **ç”¨æˆ·å**     | `hidetoshi`                               |

---

## ğŸŒ ç½‘ç»œæ¶æ„ä¸ä»£ç†ç­–ç•¥

### 1. å½“å‰ç½‘ç»œç¯å¢ƒç°çŠ¶

- **å®¿ä¸»æœº (Mac)**ï¼šå·²å¼€å¯å…¨å±€ VPNï¼ˆTUN æ¨¡å¼ï¼‰ã€‚
- **è™šæ‹Ÿæœº (UTM)**ï¼šé‡‡ç”¨ **Emulated VLAN** æ¨¡å¼ã€‚
- **æµé‡è¡Œä¸º**ï¼š
  - **å¤–ç½‘è®¿é—®**ï¼šåœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œè™šæ‹Ÿæœºæµé‡é€šè¿‡ UTM ç”¨æˆ·æ€è½¬å‘ï¼Œèƒ½å¤Ÿå®Œç¾â€œç»§æ‰¿â€å®¿ä¸»æœºçš„ VPN è·¯ç”±ã€‚
  - **å†…ç½‘äº’é€š**ï¼šå®¿ä¸»æœºæ— æ³•ç›´æ¥é€šè¿‡ IP è®¿é—®è™šæ‹Ÿæœºï¼Œå¿…é¡»åœ¨ UTM è®¾ç½®ä¸­é…ç½® **Port Forwarding (ç«¯å£è½¬å‘)**ã€‚

### 2. ç«¯å£è½¬å‘é…ç½® (UTM è®¾ç½®)

åœ¨ UTM çš„è™šæ‹Ÿæœºè®¾ç½® -> ç½‘ç»œ -> ç«¯å£è½¬å‘ä¸­æ·»åŠ ä»¥ä¸‹è§„åˆ™ï¼š

| åè®® | å®¿ä¸»æœºç«¯å£ | è™šæ‹Ÿæœº IP | è™šæ‹Ÿæœºç«¯å£ |
| ---- | ---------- | --------- | ---------- |
| TCP  | `2222`     | (ç•™ç©º)    | `22`       |
| TCP  | `18789`    | (ç•™ç©º)    | `18789`    |

---

## ğŸ” å¿«é€Ÿè¿æ¥

### SSH ç™»å½•

ç”±äºå®¿ä¸»æœº IP æ— æ³•ç›´è¿ï¼Œéœ€ä¿®æ”¹ Mac `~/.ssh/config` æŒ‡å‘è½¬å‘ç«¯å£ï¼š

```ssh
Host vm
    HostName localhost
    Port 2222
    User hidetoshi
    IdentityFile ~/.ssh/id_vm
```

é…ç½®å®Œæˆåï¼Œä¾ç„¶å¯ä»¥ä½¿ç”¨ `ssh vm` ç™»å½•ã€‚

### è®¿é—®æœåŠ¡

é…ç½®äº†ç«¯å£è½¬å‘åï¼Œå¯ç›´æ¥åœ¨ Mac æµè§ˆå™¨è®¿é—®ï¼š

- **Dashboard**: [http://localhost:18789](http://localhost:18789)

---

## ğŸ¦€ OpenClaw æœåŠ¡çŠ¶æ€

| æœåŠ¡       | ç«¯å£     | è®¿é—®åœ°å€               |
| ---------- | -------- | ---------------------- |
| Dashboard  | `18789`  | http://localhost:18789 |
| API Server | (å¾…è¡¥å……) |                        |

---

## ğŸš€ æœåŠ¡ç®¡ç†

### 1. OpenClaw æœåŠ¡çŠ¶æ€
OpenClaw å·²é…ç½®ä¸º systemd ç”¨æˆ·æœåŠ¡ï¼Œè™šæ‹Ÿæœºé‡å¯åä¼šè‡ªåŠ¨å¯åŠ¨ã€‚

**æœåŠ¡ä¿¡æ¯ï¼š**
- æœåŠ¡åç§°ï¼š`openclaw-gateway.service`
- æœåŠ¡æ–‡ä»¶ï¼š`~/.config/systemd/user/openclaw-gateway.service`
- æ—¥å¿—æ–‡ä»¶ï¼š`/tmp/openclaw/openclaw-*.log`
- Dashboardï¼š`http://127.0.0.1:18789/`ï¼ˆç›‘å¬åœ¨ 0.0.0.0:18789ï¼‰

**å¸¸ç”¨å‘½ä»¤ï¼š**
```bash
# æŸ¥çœ‹ Gateway è¿è¡ŒçŠ¶æ€ï¼ˆæ¨èï¼‰
openclaw gateway status

# æŸ¥çœ‹ systemd æœåŠ¡çŠ¶æ€
systemctl --user status openclaw-gateway

# æ‰‹åŠ¨å¯åŠ¨/åœæ­¢/é‡å¯æœåŠ¡
systemctl --user start openclaw-gateway
systemctl --user stop openclaw-gateway
systemctl --user restart openclaw-gateway

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
journalctl --user -u openclaw-gateway -f

# æˆ–æŸ¥çœ‹æ–‡ä»¶æ—¥å¿—
tail -f /tmp/openclaw/openclaw-*.log
```

### 3. ä»£ç†æœåŠ¡ (Clash TUN)
ç¡®ä¿è™šæ‹Ÿæœºèƒ½é¡ºç•…è®¿é—®å¤–ç½‘ï¼Œéœ€å¯åŠ¨ä»£ç†å¹¶å¼€å¯ TUN æ¨¡å¼ï¼š
```bash
# æ£€æŸ¥ Clash è¿è¡ŒçŠ¶æ€
systemctl status clash

# å¯åŠ¨ Clash
sudo systemctl start clash
```

---

## ğŸ› ï¸ ç»´æŠ¤æ—¥å¿—

- **2026-02-11**: åˆ‡æ¢ç½‘ç»œæ¨¡å¼è‡³ **Emulated VLAN** ä»¥å…¼å®¹å®¿ä¸»æœº VPNï¼Œå¹¶å¯ç”¨ç«¯å£è½¬å‘ï¼ˆSSH: 2222, Dashboard: 18789ï¼‰ã€‚
- **2026-02-11**: æ˜ç¡®å½“å‰ç½‘ç»œç¯å¢ƒç°çŠ¶ï¼Œç¡®å®šè™šæ‹Ÿæœºå†…éƒ¨å¼€å¯ç‹¬ç«‹ TUN çš„ä»£ç†æ–¹æ¡ˆã€‚
- **2026-02-07**: åˆå§‹ç¯å¢ƒæ­å»ºï¼Œå®Œæˆ SSH åˆ«åé…ç½®ã€‚
