# OpenClaw VM Environment (UTM)

> 最后更新: 2026-02-11
> 用途: OpenClaw 开发与运行环境

---

## 📦 虚拟机基本信息

| 项目 | 信息 |
|------|------|
| **虚拟化软件** | UTM |
| **操作系统** | Ubuntu 24.04 LTS (ARM64) |
| **存储位置** | 外接硬盘 (启动前请确保已挂载) |
| **IP 地址** | `192.168.64.2` |
| **网关/宿主机** | `192.168.64.1` |
| **用户名** | `hidetoshi` |

---

## 🌐 网络架构与代理策略

### 1. 当前网络环境现状
*   **宿主机 (Mac)**：已开启全局 VPN（TUN 模式）。
*   **虚拟机 (UTM)**：通过虚拟交换机连接，处于 `192.168.64.0/24` 网段。
*   **流量行为**：由于 macOS 虚拟化框架的特性，虚拟机的 NAT 流量往往会**绕过**宿主机的 TUN 网卡直接出口。因此，即使 Mac 开启了 VPN，虚拟机内部仍可能处于直连（直连大陆）状态，导致 GitHub 或 Docker Hub 访问失败。

### 2. 推荐代理方案：虚拟机内开启独立 TUN
为了彻底解决环境变量被跳过及宿主机 VPN 拦截失效的问题：
1.  **独立代理**：在 Ubuntu 内部运行代理客户端（如 Clash ）。
2.  **开启 TUN**：使用透明代理模式拦截系统全局流量。
3.  **优势**：
    *   **全协议拦截**：无需配置 `http_proxy`，支持 ICMP (ping) 和所有 TCP/UDP 流量。
    *   **解决偷跑**：防止 Go/Rust 编译的程序或 Docker 守护进程绕过代理环境变量。
    *   **DNS 防污染**：由虚拟机内部代理接管 DNS 解析。

---

## 🔐 快速连接

### SSH 登录
已在 Mac `~/.ssh/config` 配置别名：
```bash
ssh vm
```

### 端口转发
若需在 Mac 浏览器访问虚拟机内的服务：
```bash
# 将虚拟机 Dashboard 端口映射到 Mac 本地
ssh -L 18789:localhost:18789 vm
```

---

## 🦀 OpenClaw 服务状态

| 服务 | 端口 | 访问地址 |
|------|------|----------|
| Dashboard | `18789` | http://192.168.64.2:18789 |
| API Server | (待补充) | |

---

## 🛠️ 维护日志
- **2026-02-11**: 明确当前网络环境现状，确定虚拟机内部开启独立 TUN 的代理方案。
- **2026-02-07**: 初始环境搭建，完成 SSH 别名配置。