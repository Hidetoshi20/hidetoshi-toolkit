# Prompt · Bug 修复

> 适用：线上/测试环境的异常、接口报错、白屏、崩溃、边界缺陷。

## 0. Bug report
```text
请把以下信息整理成 bug report：
- 环境/URL：<粘贴>
- 复现步骤：<步骤>
- 预期 vs 实际：<描述>
- 日志/报错栈：<粘贴>
- 影响范围或猜测根因：<描述>
- 设计文档引用：<相关章节 / 暂缺>
输出：
1. 标题 + 严重级别
2. 复现步骤（编号）
3. 预期 vs 实际（并列表格）
4. 影响范围（组件/用户/数据）
5. 暂定根因假设 or 待确认问题
6. 设计文档影响（需要同步的章节或确认无需更新的理由）
```

## 1. 根因定位计划
```text
根据 bug report 和下面的代码片段，推测最可能的根因：
<粘贴相关代码/堆栈>
请回答：
- 哪段逻辑（文件/行）会在什么条件下触发错误？
- 需要观察哪些变量/状态以确认？
- 最小修复策略是什么？为什么不引入额外副作用？
- 是否需要更新设计文档？如果是，写出章节/链接；如果不是，注明原因（例如“实现 bug，设计文档已正确”）。
并拆成 Step 1（复现+确认）/ Step 2（最小修复+回归）。
```

## 2. 修复 patch
```text
针对 Step 2，输出：
1. diff（unified diff）
2. 说明：
   - 防御手段（null check/guard/retry 等）
   - 对正常路径的影响
   - 若需要新增日志/监控，写明
保持改动最小，不顺便重构。
```

## 3. 自测 / 回归
```text
请列出验证顺序：
1. 原复现步骤（确认 bug 消失）
2. 主流程回归
3. 边界输入（null/empty/timeout/慢网）
4. 权限/多角色/多 tab 同时操作
按风险降序列出，说明每一项为何重要。
```

## 4. Commit / PR
```text
输出：
- commit message（fix: ...）
- PR title + summary（含 Root cause + Fix + Verification）
- Test Plan（引用自测）
- Rollout & Monitoring（是否需要 Feature flag / 观察日志）
- Design doc Sync（design.md#章节 更新情况 / 无需更新 + 理由）
```
