# Prompt · 新页面 / 新路由

> 适用：新增 `/settings`、`/reports/:id`、Dashboard 等独立视图；需要从零接上路由、布局、数据源。

## 0. 任务定义 / 背景收集
```text
你是协作式结对工程师，帮我把下面的页面需求整理成 spec.md。
输入：
- 页面概述：<粘贴 product brief>
- 数据来源 / API / 字段：<粘贴 or 留空待补>
- 交互要求（分页、筛选、编辑等）：<描述>
- 设计约束（layout、主题、响应式）：<描述>
- 设计文档：<链接/章节；若需新建请注明>
输出：
1. 功能目标（用户视角）
2. 数据契约（字段/类型/状态）
3. 交互流程（文字步骤即可）
4. 范围内 / 范围外
5. 验收标准（肉眼可见行为）
6. 已知风险或依赖
7. 设计文档影响（需要更新的章节名称 / 若无需更新请说明原因）
若信息不足，请列出需要澄清的问题。
```

## 1. 任务分解 / 施工计划
```text
基于上述 spec.md，把实现过程拆成最小可提交步骤（5-30 行 diff）。
对每个 step，写：
- 目标（一句话）
- 要修改/新建的文件路径（含包名）
- 关键数据结构或组件（新增/复用/修改）
- 完成后我可以如何肉眼验收
确保顺序可独立提交（shell → 接口 → 渲染 → 交互 → 状态/文案收口 → QA）；若某步是“同步设计文档”，请写清楚章节锚点和完成标记。
```

## 2. 上下文装载
```text
以下为现有上下文：
- 路由 / Layout 代码：<粘贴>
- 状态管理 / 数据层：<粘贴>
- 需要复用的组件：<粘贴>
请给我 patch plan：
1. 新页面壳、路由注册、layout 嵌入分别在哪些文件改？
2. 数据获取应该复用哪个 hook/service？
3. 交互（筛选/按钮/Modal）分别放在什么层？
要求最小侵入、禁止引入新的状态管理方式；如需新增抽象，请说明原因。
```

## 3. 生成 patch（逐步）
```text
只针对 Step <编号> 产出最小 diff：
- 涉及文件：<列出>
- 需求：<一句话>
Diff 要符合 unified diff 风格；禁止引用未展示过的符号，如需现有 hook 请显式声明。
输出：
1. diff 代码块
2. 变更说明（包含潜在副作用）
```
> 完成 Step N 后再请求 Step N+1 的 diff，保持 patch 小而可审计。

## 4. 自测 / 回归
```text
假设最新 patch 已应用，请列出：
1. 手测路径（URL + 点击步骤 + 预期）
2. Loading / error / empty 状态如何验证
3. 可能受影响的旧功能或路由，按风险排序
输出格式：
- 功能验收 checklist
- 回归点 checklist（含 why）
```

## 5. Commit / PR
```text
基于当前 steps，请给：
1. 建议的 commit 列表（语义：feat/fix/refactor/chore/test/docs），每条 1 句说明
2. PR title
3. PR summary（2-3 段，涵盖动机/实现/副作用）
4. Test Plan（引用上面 checklist）
5. Risk & Rollout（包括监控或灰度策略）
6. Design doc Sync（已更新 design.md#章节 / 无需更新 + 理由）
```
